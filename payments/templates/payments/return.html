{% extends "payments/base.html" %}
{% block title %}نتيجة الدفع — Mujeb{% endblock %}
{% load humanize %}

{% block content %}
<div class="max-w-2xl mx-auto bg-white rounded-2xl shadow p-8 text-center" dir="rtl">
  <h2 class="text-2xl font-bold mb-6">نتيجة الدفع</h2>

  {% if verify %}
    {% if verify.payment_result and verify.payment_result.response_status == "A" %}
      <div class="flex flex-col items-center mb-6">
        <div class="bg-green-100 text-green-700 p-4 rounded-full mb-3">✅</div>
        <h3 class="text-xl font-semibold text-green-700">تم الدفع بنجاح</h3>
        <p class="text-gray-600 mt-2">شكرًا لك! تم استلام دفعتك بنجاح.</p>
      </div>
    {% else %}
      <div class="flex flex-col items-center mb-6">
        <div class="bg-red-100 text-red-700 p-4 rounded-full mb-3">❌</div>
        <h3 class="text-xl font-semibold text-red-700">فشل الدفع</h3>
        <p class="text-gray-600 mt-2">للأسف لم تتم العملية. يرجى المحاولة مرة أخرى.</p>
      </div>
    {% endif %}
  {% else %}
    <div class="text-gray-600 mb-6">لم يتم العثور على نتيجة التحقق.</div>
  {% endif %}

  {% if verify and verify.payment_result and verify.payment_result.response_status == "A" %}
  <div class="bg-gray-50 rounded-lg p-4 text-right mb-6">
    <h4 class="font-medium text-gray-700 mb-3">تفاصيل العملية</h4>
    <table class="w-full text-sm text-gray-700">
      <tr class="border-b">
        <td class="py-2 font-semibold">رقم العملية:</td>
        <td class="py-2">{{ verify.tran_ref|default:"—" }}</td>
      </tr>
      <tr class="border-b">
        <td class="py-2 font-semibold">المبلغ:</td>
        <td class="py-2">{{ verify.cart_amount|floatformat:2|intcomma }} {{ verify.cart_currency|default:"" }}</td>
      </tr>
      <tr class="border-b">
        <td class="py-2 font-semibold">البريد الإلكتروني:</td>
        <td class="py-2">{{ verify.customer_details.email|default:"—" }}</td>
      </tr>
    </table>
  </div>
  {% endif %}

  <div class="flex justify-center gap-4">
    <a href="/" class="px-5 py-2 bg-gray-200 hover:bg-gray-300 text-gray-800 rounded-lg text-sm font-medium">
      الرجوع
    </a>
    {% if verify and verify.payment_result and verify.payment_result.response_status == "A" %}
    <a href="/" class="px-5 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg text-sm font-medium">
      متابعة
    </a>
    {% endif %}
  </div>
</div>
{% endblock %}
